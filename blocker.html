<html>
    <head>
        
        <title>Website Blocking</title>

        <meta charset=utf-8>
        <meta name=viewport content="width=device-width, initial-scale=1.0">

        <link href='https://fonts.googleapis.com/css?family=DM Sans' rel='stylesheet'>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

        <link href="files/tools.css" rel="stylesheet">

<style>

#botnav1 {
    bottom: 0;
    z-index: 1;
    display: flex;
}

#modeList {
    width: 80%;
    margin: 0 10px 0 0;
    overflow: auto;
    white-space: nowrap;
}

#modeList section {
    display: inline-block;
    margin: 6px;
    padding: 10px;
    background-color: var(--dark3);
    border-radius: 4px;
    cursor: pointer;
}

#modeList svg {
    margin: 0 -2px -4px 2px;
}

#modeBtnHold button {
    width: 100%;
    padding: 10px;
    margin: 7px 0;
}

#modeBtnHold {
    width: 20%;
}

#modeDetails {
    z-index: 4;
    padding: 20px;
    backdrop-filter: blur(4px);
    background-color: var(--transP1);
}

#closeDiv1 {
    float: right;
    margin: -30px 0 0 0;
    padding: 10px;
}

#detailsHold {
    max-width: 500px;
    margin: 20vh auto;
    padding: 20px;
    background-color: var(--dark1);
    border-radius: 4px;
}

.fixedDiv {
    position: fixed;
    top: 0;
    bottom: 0;
    right: 0;
    left: 0;
}

#subBtn {
    padding: 10px 30px;
    color: var(--white1);
    font-size: 16px;
    background-color: transparent;
    border: 2px solid var(--white1);
    margin: 0 0 0 10px;
}

#subBtn:hover {
    background-color: var(--white1);
    color: var(--dark1);
}

#form1 {
    display: flex;
    justify-content: space-around;
    max-width: 500px;
    margin: 0 auto;
}

#btnHold {
    margin: 30px 0 10px 0;
}

#detailsBtn button {
    padding: 10px 30px;
    font-size: 16px;
}

#btnHold button {
    margin: 0 10px;
    padding: 10px 20px;
    font-size: 16px;
}

#webList, #webList2 {
    text-align: left;
    font-size: 16px;
    padding: 20px;
    border-radius: 2px;
    max-width: 460px;
    margin: 20px auto;
}

#webList {
    background-color: var(--dark1);
}

#webList2 {
    background-color: var(--dark4);
    max-height: 100px;
    overflow-y: scroll;
}

#webList .redclr {
    float: right;
    cursor: pointer;
}

#listHold {
    margin: 20px 0 0 0;
    font-size: 16px;
    color: var(--dark2);
    padding: 10px;
    max-height: 200px;
    overflow-y: scroll;
    border-radius: 4px;
    border: 2px solid var(--transP1);
}

#blockA {
    position: fixed;
    top: 10px;
    right: 0;
    left: 0;
    margin: -100px 0 0 0;
    transition: 1s all;
    z-index: 5;
}

#blockChild {
    margin: 0 auto;
    background-color: var(--dark1);
    border-radius: 6px;
    max-width: 200px;
}

#alertH {
    padding: 20px;
    border-radius: 6px;
}

.redAlert {
    border: 2px solid var(--red1);
    background-color: var(--red2);
}

.greenAlert {
    border: 2px solid var(--green1);
    background-color: var(--green2);
}

</style>

    </head>
    <body>
        <section id="blockA"><section id="blockChild"><section id="alertH"></section></section></section>
        <section id="topnav1">
            <section id="menu1" onclick="sidenavF()"></section>
            <section id="cross1" onclick="exitNav()"></section>
            <span class="text1">Website Blocking</span>
            <section id="mode1" title="Toggle Dark/Light Mode"></section>
        </section>

        <section id="mainHold">
            <form id="form1">
                <input id="web1" class="web1" type="text" placeholder="Enter a website" autocomplete="off" required>
                <button id="subBtn" type="submit">Add</button>
            </form>
            
            <section id="webList">
                <span class="white2clr">List of websites added:</span>
                <span title="Clear the list added" class="redclr" onclick="clearForm()">Clear</span><br>
                <section id="listHold"></section>
                <section id="btnHold" class="flex">
                    <button class="redbtn" onclick="blockWeb1('listHold', 'NaN', 'B')">Block</button><button class="bluebtn" onclick="createMode1()">Create New Mode</button>
                </section>
            </section>

            <!--Hidden form to submit the list added-->
            <form action="/block" id="form2" class="noneD" method="post">
                <input id="webList3" name="webList3" required>
                <input id="listID" name="listID" required>
                <input id="action1" name="action1" required>
                <button id="form2Btn" type="submit"></button>
            </form>

        </section>

        <section id="modeDetails" class="fixedDiv">
            <section id="detailsHold">
                <section  id="modeName"></section>
                <section id="closeDiv1" onclick="hideDetails()"></section>
                <section id="webList2"></section>
                <section id="detailsBtn" class="flex"></section>
            </section>
        </section>

        <section id="sidenav" class="fixedDiv">
            <section id="sidediv">
                <section class="text1">Navigate:</section><br>
                <section id="sidenavLinks"></section>
            </section>
            <section id="dummydiv" onclick="exitNav()"></section>
        </section>

        <section id="botnav1">
            <section id="modeList"></section>
            <section id="modeBtnHold"><button class="bluebtn" onclick="resetAll()" title="Reset all the modes and blocked websites">Reset</button></section>
        </section>
        
<script src="files/tools.js"></script>
<script>

modeList = getId('modeList');
modeName = getId('modeName');
webList2 = getId('webList2');
detailsBtn = getId('detailsBtn');
closeDiv1 = getId('closeDiv1');

function svgDot(num){
    return `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--circle${num})" stroke-width="8" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-dot"><circle cx="12.1" cy="12.1" r="1"/></svg>`
}

modeNum = Number(localStorage.getItem("modeNum"));

if(modeNum == null || modeNum == undefined || modeNum == 0){
    localStorage.setItem("modeNum", 1);
    localStorage.setItem('mode1', JSON.stringify(['Mode1', 0, 'examplewebsite.com<br>', 'id2525']))
    modeNum = 1;
}

arrMode = [];

function getArr1(){
    arrMode = []
    count1=localStorage.getItem("modeNum")
    for (i=0; i<count1; i++){
        arrMode.push(JSON.parse(localStorage.getItem(`mode${i+1}`)))
    }
}

getArr1();

time1 = setTimeout(() => {}, 0);

function showAlert(text, action){
    clearTimeout(time1)
        getId('blockA').style.setProperty('margin', '0');
        time1 = setTimeout(() => {
            getId('blockA').style.setProperty('margin', '-100px 0 0 0');
        }, 2000);
        getId('alertH').innerHTML = text;
        if(action=='B'){
            getId('alertH').classList.remove("greenAlert");
            getId('alertH').classList.add("redAlert");
        } else {
            getId('alertH').classList.remove("redAlert");
            getId('alertH').classList.add("greenAlert");
        }
}

function webListF(num){
    tempList1 = '';
    tempList1 += arrMode[num][2];
    return tempList1
}

function createMode1(){
    val2 = getId('listHold').innerHTML;
    if (val2 != ''){
        const d1 = new Date();
        id1 = String(d1.getFullYear())+String(d1.getMonth())+String(d1.getDate())+String(d1.getHours())+String(d1.getMinutes())+String(d1.getSeconds())+String(d1.getMilliseconds())
        modeNum= Number(localStorage.getItem('modeNum'))+1;
        localStorage.setItem(`mode${modeNum}`, JSON.stringify([prompt('Enter mode name:'), 0, val2, id1]));
        localStorage.setItem("modeNum", modeNum);
        getId('listHold').innerHTML='';
        getArr1();
        showModes();
    } else {
        showAlert('Enter a website first', 'B')
    }
}

function deleteMode1(num){
    modeNum = Number(localStorage.getItem("modeNum"));
    num3=num+1;
    tempModeAc = Number(JSON.parse(localStorage.getItem('mode'+num3))[1]);
    id1 = tempModeAc = JSON.parse(localStorage.getItem('mode'+num3))[3];
    localStorage.removeItem("mode"+num3);
    localStorage.setItem("modeNum", modeNum-1);
    for(i = num3+1; i <= modeNum; i++){
        delMode1 = localStorage.getItem("mode"+i);
        delNum1 = i-1;
        localStorage.setItem("mode"+delNum1, delMode1);
        localStorage.removeItem("mode"+i)
    }
    getArr1();
    showModes();
    hideDetails();
    if(tempModeAc==1){blockWeb1('webList2', id1, 'UB')}
}

function switchB(num, stat){
    num2 = num+1;
    modeTemp = JSON.parse(localStorage.getItem('mode'+num2));
    id1 = modeTemp[3];
    if (stat==0){
        localStorage.setItem('mode'+num2, JSON.stringify([modeTemp[0], 1, modeTemp[2], modeTemp[3]]))
    } else {
        localStorage.setItem('mode'+num2, JSON.stringify([modeTemp[0], 0, modeTemp[2], modeTemp[3]]))
    }
    getArr1();
    showDetails1(num);
    showModes();
    if(stat==0){
        blockWeb1('webList2', id1, 'B');
    } else {
        blockWeb1('webList2', id1, 'UB');
    }
}

function clearForm(){
    getId('listHold').innerHTML='';
}

function resetAll(){
    for(i=1; i<=modeNum; i++){
        localStorage.removeItem('mode'+i)
    }
    localStorage.setItem('modeNum', 0);
    arrMode=[];
    showModes();
    getId('listHold').innerHTML = 'RESET'
    blockWeb1('listHold', 'NaN', 'NaN');
}

function showDetails1(num){
    butArr = ['Activate', 'Deactivate'];
    activeSt = arrMode[num][1];
    $('#modeDetails').fadeIn();
    detailsBtn.innerHTML = `<button class="transbtn" onclick="switchB(${num}, ${activeSt})">${butArr[activeSt]}</button>
    <button class="redbtn" onclick="deleteMode1(${num})">Delete</button>`;
    modeName.innerHTML = arrMode[num][0];
    webList2.innerHTML = webListF(num);
    closeDiv1.innerHTML = svgCross2;
}

function hideDetails(){
    $('#modeDetails').fadeOut();
    showModes();
}

function showModes(){
    modeList.innerHTML='';
    for (i=0; i<arrMode.length; i++){
        modeList.innerHTML+=`<section onclick="showDetails1(${i})">${arrMode[i][0]}${svgDot(arrMode[i][1])}</section>`
    }
}

getId("form1").addEventListener("submit", event=>{
    event.preventDefault();
    val1 = getId('web1').value;
    if ((val1.includes(".com") || val1.includes(".in")) && val1.length>4 && !val1.includes(" ")){
        getId('listHold').innerHTML += `${val1}<br>`;
    }
    else {
        showAlert("Enter a valid website", 'B')
    }
    getId('web1').value = '';
});

function blockWeb1(list, id, action){
    if(getId(list).innerHTML==''){
        showAlert('Enter a website first', 'B')
    } else {
        if(action=='B'){
            showAlert("Websites Blocked", 'B')
        } else {
            showAlert("Websites Unlocked", 'UB')
        }
        getId('webList3').value = getId(list).innerHTML;
        getId('listHold').innerHTML='';
        getId('listID').value=id;
        getId('action1').value=action;
        getId('form2Btn').click();
    }
}

//linksArr = [['/', 'Home'], ['/encrypter', 'Encryption'], ['/STencrypter', 'Steganography']]
linksArr = [['index.html', 'Home'], ['encrypter.html', 'Encryption'], ['stgraphy.html', 'Steganography']]

for (i=0; i<linksArr.length; i++){
    getId("sidenavLinks").innerHTML += `<span onclick="window.open('${linksArr[i][0]}', '_self')">${linksArr[i][1]}</span>`;
}

$('#modeDetails').hide();
exitNav();
showModes();

</script>

    </body>
</html>